

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HTML To PDF Solutions / HTML 转换 PDF 解决方案 &mdash; KNWON Blog documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="KNWON Blog documentation" href="../index.html"/>
        <link rel="up" title="Tools" href="Tools.html"/>
        <link rel="next" title="Mount disk to VG / 磁盘挂载到虚拟分区" href="Tools_DiskMount.html"/>
        <link rel="prev" title="Tools" href="Tools.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> KNWON
          

          
          </a>

          
            
            
              <div class="version">
                Blog
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Index</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Tools.html">Tools</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">HTML To PDF Solutions / HTML 转换 PDF 解决方案</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#intro">Intro / 简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sample-files">Sample Files / 示例文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#phantomjs"><code class="code docutils literal"><span class="pre">phantomjs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation">Installation / 安装</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage-in-js-js">Usage in JS / JS  调用</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wkhtmltopdf"><code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Installation / 安装</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage-in-command-line">Usage in Command Line / 命令行使用</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Usage in JS / JS 使用</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#other-tips">Other Tips / 其他</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#charts-can-be-partial">Charts can be partial / 图表显示不全</a></li>
<li class="toctree-l4"><a class="reference internal" href="#jquery-3-3-1-is-not-fully-compatible-with-wkhtmltopdf">jQuery 3.3.1 is not fully compatible with wkhtmltopdf</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Tools_DiskMount.html">Mount disk to VG / 磁盘挂载到虚拟分区</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tools_fonts.html">Linux Fonts / 字体支持</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tools_LocalYumRepo.html">Local Yum Repo (CentOS 7) / 本地Yum源</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tools_NSSM_Windows.html">Program As Service at Windows Using NSSM</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tools_PDFToWord.html">PDF To Word / PDF转Word格式</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tools_RPM.html">Build RPM / 构建 RPM</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tools_Sphinx.html">Sphinx And RST</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Web/Web.html">Web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Node/Node.html">Node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Python/Python.html">Python</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">KNWON</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="Tools.html">Tools</a> &raquo;</li>
      
    <li>HTML To PDF Solutions / HTML 转换 PDF 解决方案</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/Tools/HtmlToPdf.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="html-to-pdf-solutions-html-pdf">
<h1><a class="toc-backref" href="#id3">HTML To PDF Solutions / HTML 转换 PDF 解决方案</a><a class="headerlink" href="#html-to-pdf-solutions-html-pdf" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">date:</th><td class="field-body">2019-01-10</td>
</tr>
<tr class="field-even field"><th class="field-name">tags:</th><td class="field-body">phantomjs, wkhtmltopdf, PDF, HTML</td>
</tr>
<tr class="field-odd field"><th class="field-name">category:</th><td class="field-body">Tools</td>
</tr>
<tr class="field-even field"><th class="field-name">slug:</th><td class="field-body">HTML_To_PDF_Solutions</td>
</tr>
<tr class="field-odd field"><th class="field-name">author:</th><td class="field-body">Brian Shen</td>
</tr>
<tr class="field-even field"><th class="field-name">summary:</th><td class="field-body">HTML To PDF Solutions</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<span id="html-to-pdf-solutions"></span><p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#html-to-pdf-solutions-html-pdf" id="id3">HTML To PDF Solutions / HTML 转换 PDF 解决方案</a><ul>
<li><a class="reference internal" href="#intro" id="id4">Intro / 简介</a></li>
<li><a class="reference internal" href="#sample-files" id="id5">Sample Files / 示例文件</a></li>
<li><a class="reference internal" href="#phantomjs" id="id6"><code class="code docutils literal"><span class="pre">phantomjs</span></code></a><ul>
<li><a class="reference internal" href="#installation" id="id7">Installation / 安装</a></li>
<li><a class="reference internal" href="#usage-in-js-js" id="id8">Usage in JS / JS  调用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wkhtmltopdf" id="id9"><code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code></a><ul>
<li><a class="reference internal" href="#id1" id="id10">Installation / 安装</a></li>
<li><a class="reference internal" href="#usage-in-command-line" id="id11">Usage in Command Line / 命令行使用</a></li>
<li><a class="reference internal" href="#id2" id="id12">Usage in JS / JS 使用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-tips" id="id13">Other Tips / 其他</a><ul>
<li><a class="reference internal" href="#charts-can-be-partial" id="id14">Charts can be partial / 图表显示不全</a></li>
<li><a class="reference internal" href="#jquery-3-3-1-is-not-fully-compatible-with-wkhtmltopdf" id="id15">jQuery 3.3.1 is not fully compatible with wkhtmltopdf</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="intro">
<h2><a class="toc-backref" href="#id4">Intro / 简介</a><a class="headerlink" href="#intro" title="Permalink to this headline">¶</a></h2>
<p>There are many situations that we need to generate reports in PDF. And there are many solutions.</p>
<ul class="simple">
<li>Use libraries to manipulate pdf content. That suffers.</li>
<li>Use html and then render it to PDF. That&#8217;s wonderful.</li>
</ul>
<p>I think everyone like the last solution since you can always have a preview.</p>
<p>And to render html to PDF, there are many solutions.
But the most popular ones are <code class="code docutils literal"><span class="pre">phantomjs</span></code> and <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> .</p>
<p>I thought <code class="code docutils literal"><span class="pre">phantomjs</span></code> would be more popular if it&#8217;s still under maintenance.
Unfortunately, it doesn&#8217;t. So the lack of some necessary features makes <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> an appearing alternative.</p>
<p>In my project, I used to generate PDF using <code class="code docutils literal"><span class="pre">phantomjs</span></code> . One day a customer asked for a menu.
And I found it unable to fulfill.
And then I began to use <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> .</p>
<p>However, there are some problems both. And I&#8217;ll explain.</p>
<p>很多情况下， 我们需要产生PDF的报告。 因此也有很多现存的解决方案：</p>
<ul class="simple">
<li>可以使用 PDF 库 去操作PDF 的内容， 那会非常的痛苦</li>
<li>使用HTML 然后 渲染为PDF， 那会很好</li>
</ul>
<p>我想每个人都改会喜欢后一种解决方案， 因为你永远可以有一个预览。</p>
<p>至于 将 HTML 转换为 PDF， 现在也有很多的解决方案。 最流行的就是 <code class="code docutils literal"><span class="pre">phantomjs</span></code> 和 <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> 。</p>
<p>我想 <code class="code docutils literal"><span class="pre">phantomjs</span></code> 会更加的流行 如果 它还在被维护的话。 可惜的是，他被停止维护了。 一些基础必要功能的缺少使得 <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> 称为很好的选择。</p>
<p>我曾使用 <code class="code docutils literal"><span class="pre">phantomjs</span></code> 产生 PDF，但是后来客户需要 一个 目录，<code class="code docutils literal"><span class="pre">phantomjs</span></code> 不具备这样的功能。因为我转向了 <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> 。</p>
</div>
<div class="section" id="sample-files">
<h2><a class="toc-backref" href="#id5">Sample Files / 示例文件</a><a class="headerlink" href="#sample-files" title="Permalink to this headline">¶</a></h2>
<p>To compare the render results of the two Scriptable Headless Browser. We will use the following samples.</p>
<p>为了对比渲染结果，我们使用以下的示例。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>./resources/
├── DailyReport.js
├── DailyReport1x.html
├── DailyReport3x.html
├── Report.css
├── echarts.common.min.js
├── jquery-1.12.4.min.js
└── jquery-3.3.1.min.js
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">DailyReport1x.html</span></code> (We render a link and a chart / 我们渲染一个 连接 和 图表):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&lt;!DOCTYPE html&gt;
&lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span>&gt;
&lt;head&gt;
&lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span>&gt;
&lt;title&gt;Daily Report&lt;/title&gt;
&lt;link <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;Report.css&quot;</span>&gt;
&lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;jquery-1.12.4.min.js&quot;</span>&gt;&lt;/script&gt;
&lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;echarts.common.min.js&quot;</span>&gt;&lt;/script&gt;
&lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;DailyReport.js&quot;</span>&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&quot;page&quot;</span>&gt;
    &lt;div&gt;
    &lt;h2&gt;Menu&lt;/h2&gt;
    &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&quot;chartDiv&quot;</span>&gt;
        &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;#chartDiv&quot;</span>&gt;● Test Internal Link&lt;/a&gt;
        &lt;br /&gt;
    &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&quot;page&quot;</span>&gt;
    &lt;div <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;height:100mm; width:180mm;&quot;</span> <span class="nv">id</span><span class="o">=</span><span class="s2">&quot;chartDiv&quot;</span>&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">DailyReport.js</span></code> :</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="k">function</span> drawPie<span class="o">()</span> <span class="o">{</span>
  var <span class="nv">chartOptions</span> <span class="o">=</span> <span class="o">{</span>
    animation: false,
    xAxis: <span class="o">{</span>
      type: <span class="s1">&#39;category&#39;</span>,
      data: <span class="o">[</span><span class="s1">&#39;Mon&#39;</span>, <span class="s1">&#39;Tue&#39;</span>, <span class="s1">&#39;Wed&#39;</span>, <span class="s1">&#39;Thu&#39;</span>, <span class="s1">&#39;Fri&#39;</span>, <span class="s1">&#39;Sat&#39;</span>, <span class="s1">&#39;Sun&#39;</span><span class="o">]</span>
    <span class="o">}</span>,
    yAxis: <span class="o">{</span>
      type: <span class="s1">&#39;value&#39;</span>
    <span class="o">}</span>,
    series: <span class="o">[{</span>
      data: <span class="o">[</span>820, 932, 901, 934, 1290, 1330, 1320<span class="o">]</span>,
      type: <span class="s1">&#39;line&#39;</span>
    <span class="o">}]</span>
  <span class="o">}</span><span class="p">;</span>
  var <span class="nv">myChart</span> <span class="o">=</span> echarts.init<span class="o">(</span>document.getElementById<span class="o">(</span><span class="s1">&#39;chartDiv&#39;</span><span class="o">))</span><span class="p">;</span>
  myChart.setOption<span class="o">(</span>chartOptions<span class="o">)</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
<span class="k">$(</span>document<span class="k">)</span>.ready<span class="o">(</span><span class="k">function</span><span class="o">()</span> <span class="o">{</span>
  drawPie<span class="o">()</span><span class="p">;</span>
<span class="o">})</span><span class="p">;</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">Report.css</span></code> :</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>@page <span class="o">{</span>
  size: A4<span class="p">;</span>
  margin: 0<span class="p">;</span>
<span class="o">}</span>
@media print <span class="o">{</span>
  body <span class="o">{</span>
    background: white<span class="p">;</span>
  <span class="o">}</span>
  .page <span class="o">{</span>
    width: 210mm<span class="p">;</span>
    page-break-after: always<span class="p">;</span>
  <span class="o">}</span>
<span class="o">}</span>
html, body <span class="o">{</span>
  background: rgb<span class="o">(</span>241,241,241<span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
.page <span class="o">{</span>
  page-break-after: always<span class="p">;</span>
  width: 210mm<span class="p">;</span>
  background: white<span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>And preview in Chrome / 在Chrome 中预览:</p>
<div class="figure">
<img alt="../_images/htmltopdf01.png" src="../_images/htmltopdf01.png" />
</div>
<p>Print Preview / Chrome 打印预览:</p>
<div class="figure">
<img alt="../_images/htmltopdf02.png" src="../_images/htmltopdf02.png" />
</div>
</div>
<div class="section" id="phantomjs">
<h2><a class="toc-backref" href="#id6"><code class="code docutils literal"><span class="pre">phantomjs</span></code></a><a class="headerlink" href="#phantomjs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installation">
<h3><a class="toc-backref" href="#id7">Installation / 安装</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>Download from its <a class="reference external" href="http://phantomjs.org/download.html">Phantomjs Official Site</a> and move it to <code class="code docutils literal"><span class="pre">/usr/bin/</span></code> .</p>
<p>The latest and end version is <code class="code docutils literal"><span class="pre">2.1.1</span></code> .</p>
<p>从官网去下载，移动到 <code class="code docutils literal"><span class="pre">/usr/bin/</span></code>  . 最新也是最后的版本是 <code class="code docutils literal"><span class="pre">2.1.1</span></code>  .</p>
</div>
<div class="section" id="usage-in-js-js">
<h3><a class="toc-backref" href="#id8">Usage in JS / JS  调用</a><a class="headerlink" href="#usage-in-js-js" title="Permalink to this headline">¶</a></h3>
<p>We use <code class="code docutils literal"><span class="pre">html-pdf</span></code> because it is simple.</p>
<p>使用 <code class="code docutils literal"><span class="pre">html-pdf</span></code> ， 因为这样很简单。</p>
<p><code class="code docutils literal"><span class="pre">npm</span> <span class="pre">install</span> <span class="pre">html-pdf</span></code></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>const <span class="nv">fs</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">&#39;fs&#39;</span><span class="o">)</span><span class="p">;</span>
const <span class="nv">phantomjs</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">&#39;html-pdf&#39;</span><span class="o">)</span><span class="p">;</span>

const <span class="nv">SrcPath1x</span> <span class="o">=</span>
  <span class="s1">&#39;/Users/BrianShen/Code/Asia/tset/Node/testPDF/resources/DailyReport1x.html&#39;</span><span class="p">;</span>
const <span class="nv">BasePath</span> <span class="o">=</span>
  <span class="s1">&#39;file:///Users/BrianShen/Code/Asia/tset/Node/testPDF/resources/&#39;</span><span class="p">;</span>
const <span class="nv">OutPath</span> <span class="o">=</span> <span class="s1">&#39;test.pdf&#39;</span><span class="p">;</span>

const <span class="nv">genPDFPahntomJS</span> <span class="o">=</span> <span class="k">function</span><span class="o">(</span>srcPath, basePath, outPath<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> new Promise<span class="o">(</span> <span class="o">(</span>resolve, reject<span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
    fs.readFile<span class="o">(</span>srcPath, <span class="s1">&#39;UTF8&#39;</span>, <span class="k">function</span><span class="o">(</span>errfs, html<span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span>errfs<span class="o">)</span> <span class="o">{</span>
        reject<span class="o">(</span>errfs<span class="o">)</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="o">}</span>
      const <span class="nv">genOptions</span> <span class="o">=</span> <span class="o">{</span>
        height: <span class="s1">&#39;297mm&#39;</span>,
        width: <span class="s1">&#39;210mm&#39;</span>,
        base: basePath,
        type: <span class="s1">&#39;pdf&#39;</span>,
        border: <span class="o">{</span>
          top: <span class="s1">&#39;12mm&#39;</span>, // default is 0, units: mm, cm, in, px
          right: <span class="s1">&#39;0&#39;</span>,
          bottom: <span class="s1">&#39;0&#39;</span>,
          left: <span class="s1">&#39;0&#39;</span>,
        <span class="o">}</span>,
        paginationOffset: 1, // Override the initial pagination number
        footer: <span class="o">{</span>
          height: <span class="s1">&#39;20mm&#39;</span>,
          contents: <span class="o">{</span>
            first: <span class="s1">&#39; &#39;</span>,
            default:<span class="s1">&#39;{{page}}/{{pages}}&#39;</span>,
          <span class="o">}</span>,
        <span class="o">}</span>,
      <span class="o">}</span><span class="p">;</span>
      phantomjs.create<span class="o">(</span>html, genOptions<span class="o">)</span>.toFile<span class="o">(</span>outPath, <span class="o">(</span>err, res<span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span>err<span class="o">)</span> <span class="o">{</span>
          reject<span class="o">(</span>err<span class="o">)</span><span class="p">;</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="o">}</span>
        resolve<span class="o">(</span>res<span class="o">)</span><span class="p">;</span>
      <span class="o">})</span><span class="p">;</span>
    <span class="o">})</span><span class="p">;</span>
  <span class="o">})</span><span class="p">;</span>
<span class="o">}</span>

genPDFPahntomJS<span class="o">(</span>SrcPath1x, BasePath, OutPath<span class="o">)</span>.then<span class="o">(</span> <span class="o">()</span> <span class="o">=</span>&gt; <span class="o">{</span>
  console.log<span class="o">(</span><span class="s1">&#39;Success&#39;</span><span class="o">)</span><span class="p">;</span>
<span class="o">})</span>.catch<span class="o">(</span> <span class="o">(</span>err<span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
  console.log<span class="o">(</span>err<span class="o">)</span><span class="p">;</span>
<span class="o">})</span>
</pre></div>
</div>
<p>let&#8217;s see the result / 看看结果:</p>
<div class="figure">
<img alt="../_images/htmltopdf03.png" src="../_images/htmltopdf03.png" />
</div>
<p>Very strange, isn&#8217;t it?</p>
<p><code class="code docutils literal"><span class="pre">phantomjs</span> <span class="pre">2.1.1</span></code> has a very strange bug, that the size of printed page is only 75% as big as the standard page. For example, for A4 with 29.7*21. When we design our html, we can only use (29.7 * 0.75) * (21 * 0.75) .</p>
<p>And the fatal fault is that the internal hyperlink in the PDF cannot be clicked!</p>
<p>非常的奇怪。 <code class="code docutils literal"><span class="pre">phantomjs</span> <span class="pre">2.1.1</span></code> 有一个非常奇怪的bug，大的A4 是平常 A4 的 75% 。 这就意味着你在设计html 的时候要按照75%的比例进行设计.</p>
</div>
</div>
<div class="section" id="wkhtmltopdf">
<h2><a class="toc-backref" href="#id9"><code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code></a><a class="headerlink" href="#wkhtmltopdf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id10">Installation / 安装</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>OK, still download from <a class="reference external" href="https://wkhtmltopdf.org/downloads.html">wkhtmltopdf Official Site</a>  and install.</p>
<p>仍然从 官网下载并且安装 .</p>
</div>
<div class="section" id="usage-in-command-line">
<h3><a class="toc-backref" href="#id11">Usage in Command Line / 命令行使用</a><a class="headerlink" href="#usage-in-command-line" title="Permalink to this headline">¶</a></h3>
<p>Quite simple. I just like it because it is simple and easy to begin and test.</p>
<p>非常简单，能让你快速的开始。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># wkhtmltopdf --debug-javascript --print-media-type --page-size A4 ./resources/DailyReport1x.html test.pdf</span>
Loading pages <span class="o">(</span>1/6<span class="o">)</span>
Counting pages <span class="o">(</span>2/6<span class="o">)</span>
Resolving links <span class="o">(</span>4/6<span class="o">)</span>
Loading headers and footers <span class="o">(</span>5/6<span class="o">)</span>
Printing pages <span class="o">(</span>6/6<span class="o">)</span>
Done
</pre></div>
</div>
<p>And let&#8217;s see the result: / 看一看结果。</p>
<div class="figure">
<img alt="../_images/htmltopdf04.png" src="../_images/htmltopdf04.png" />
</div>
<p>Everything works fine!</p>
<p>符合预期。</p>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id12">Usage in JS / JS 使用</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>I use <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> as it is very popular.</p>
<p>我使用的是 <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> 。</p>
<p><code class="code docutils literal"><span class="pre">npm</span> <span class="pre">install</span> <span class="pre">wkhtmltopdf</span></code></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>const <span class="nv">wkhtmltopdf</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">&#39;wkhtmltopdf&#39;</span><span class="o">)</span><span class="p">;</span>

const <span class="nv">SrcPath1x</span> <span class="o">=</span>
  <span class="s1">&#39;file:///Users/BrianShen/Code/Asia/tset/Node/testPDF/resources/DailyReport1x.html&#39;</span><span class="p">;</span>
const <span class="nv">OutPath</span> <span class="o">=</span>
  <span class="s1">&#39;./test1.pdf&#39;</span><span class="p">;</span>

const <span class="nv">genPDFWkHtmlToPdf</span> <span class="o">=</span> <span class="k">function</span><span class="o">(</span>srcPath, outPath<span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> new Promise<span class="o">(</span> <span class="o">(</span>resolve, reject<span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
    wkhtmltopdf<span class="o">(</span>srcPath, <span class="o">{</span>
      output: outPath,
      printMediaType: true,
      footerLeft: <span class="s1">&#39;[page] / [toPage]&#39;</span>,
    <span class="o">}</span>, <span class="o">(</span>err<span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span>err<span class="o">)</span> <span class="o">{</span>
        reject<span class="o">(</span>err<span class="o">)</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="o">}</span>
      resolve<span class="o">()</span><span class="p">;</span>
    <span class="o">})</span><span class="p">;</span>
  <span class="o">})</span><span class="p">;</span>
<span class="o">}</span>

genPDFWkHtmlToPdf<span class="o">(</span>SrcPath1x, OutPath<span class="o">)</span>.then<span class="o">(</span> <span class="o">()</span> <span class="o">=</span>&gt; <span class="o">{</span>
  console.log<span class="o">(</span><span class="s1">&#39;Success&#39;</span><span class="o">)</span><span class="p">;</span>
<span class="o">})</span>.catch<span class="o">(</span> <span class="o">(</span>err<span class="o">)</span> <span class="o">=</span>&gt; <span class="o">{</span>
  console.log<span class="o">(</span>err<span class="o">)</span><span class="p">;</span>
<span class="o">})</span>
</pre></div>
</div>
<p>The result / 结果:</p>
<div class="figure">
<img alt="../_images/htmltopdf05.png" src="../_images/htmltopdf05.png" />
</div>
<p>It&#8217;s as same as we rendered with command line!</p>
<p>Besides, the internal hyperlink works!</p>
<p>与 命令行中 渲染的结果是一样的。此外，内部的连接是可以使用的。</p>
</div>
</div>
<div class="section" id="other-tips">
<h2><a class="toc-backref" href="#id13">Other Tips / 其他</a><a class="headerlink" href="#other-tips" title="Permalink to this headline">¶</a></h2>
<div class="section" id="charts-can-be-partial">
<h3><a class="toc-backref" href="#id14">Charts can be partial / 图表显示不全</a><a class="headerlink" href="#charts-can-be-partial" title="Permalink to this headline">¶</a></h3>
<p>ECharts will use animation by default, so disable it.</p>
<p>ECharts 会自动的开启 动画效果。会导致延时。关闭即可。</p>
<p><code class="code docutils literal"><span class="pre">animation:</span> <span class="pre">false,</span></code></p>
</div>
<div class="section" id="jquery-3-3-1-is-not-fully-compatible-with-wkhtmltopdf">
<h3><a class="toc-backref" href="#id15">jQuery 3.3.1 is not fully compatible with wkhtmltopdf</a><a class="headerlink" href="#jquery-3-3-1-is-not-fully-compatible-with-wkhtmltopdf" title="Permalink to this headline">¶</a></h3>
<p>jQuery 3.3.1 与 wkhtmltopdf 不兼容。</p>
<p>Let&#8217;s see a sample:</p>
<p>看个例子。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&lt;!DOCTYPE html&gt;
&lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span>&gt;
&lt;head&gt;
  &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span>&gt;
  &lt;title&gt;Daily Report&lt;/title&gt;
  &lt;link <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;Report.css&quot;</span>&gt;
  &lt;script <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;jquery-3.3.1.min.js&quot;</span>&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&quot;page&quot;</span>&gt;
    &lt;div&gt;
      &lt;h2&gt;Menu&lt;/h2&gt;
      &lt;div <span class="nv">class</span><span class="o">=</span><span class="s2">&quot;chartDiv&quot;</span>&gt;
        &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;#chartDiv&quot;</span>&gt;● Test Internal Link&lt;/a&gt;
        &lt;br /&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;table <span class="nv">id</span><span class="o">=</span><span class="s2">&quot;tableDiv&quot;</span>&gt;
        &lt;tr&gt;&lt;td&gt;Test&lt;/td&gt;&lt;td&gt;Title&lt;/td&gt;&lt;/tr&gt;
      &lt;/table&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;script&gt;
  <span class="k">$(</span>document<span class="k">)</span>.ready<span class="o">(</span><span class="k">function</span><span class="o">(){</span>
    <span class="k">$(</span><span class="s1">&#39;#tableDiv&#39;</span><span class="k">)</span>.append<span class="o">(</span><span class="s1">&#39;&lt;tr&gt;&lt;td&gt;Row1&lt;/td&gt;&lt;td&gt;Row1&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="o">)</span><span class="p">;</span>
  <span class="o">})</span>
&lt;/script&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>When we open it in Chrome:</p>
<p>从Chrome 中打开。</p>
<div class="figure">
<img alt="../_images/htmltopdf06.png" src="../_images/htmltopdf06.png" />
</div>
<p>And render it with <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> :</p>
<p>使用 <code class="code docutils literal"><span class="pre">wkhtmltopdf</span></code> 去渲染。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1">#wkhtmltopdf --debug-javascript --print-media-type --page-size A4 --footer-left &quot;Page [page] of [toPage]&quot; ./resources/DailyReport3x.html test.pdf</span>
Loading pages <span class="o">(</span>1/6<span class="o">)</span>
Warning: file:///Users/BrianShen/Code/Asia/tset/Node/testPDF/resources/jquery-3.3.1.min.js:2 jQuery.Deferred exception: <span class="s1">&#39;undefined&#39;</span> is not a <span class="k">function</span>
Warning: undefined:0 TypeError: <span class="s1">&#39;undefined&#39;</span> is not a <span class="k">function</span>
Counting pages <span class="o">(</span>2/6<span class="o">)</span>
Resolving links <span class="o">(</span>4/6<span class="o">)</span>
Loading headers and footers <span class="o">(</span>5/6<span class="o">)</span>
Printing pages <span class="o">(</span>6/6<span class="o">)</span>
Done
</pre></div>
</div>
<p>It can&#8217;t work.</p>
<p>But when we switch to 1.12.4 and render it, everything works fine.</p>
<p>发生了错误。但是我们切换到 1.12.4 的 jQuery， 一切工作正常。</p>
<div class="figure">
<img alt="../_images/htmltopdf05.png" src="../_images/htmltopdf05.png" />
</div>
<p>Sad thing is that jQuery 1.12.4 is not under maintenance anymore.</p>
<p>遗憾的是，jQuery 1.12.4 不在维护了。</p>
<div data-disqus-identifier="_HTML_To_PDF_Solutions" data-disqus-shortname="brianshen1990" id="disqus_thread"></div></div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Tools_DiskMount.html" class="btn btn-neutral float-right" title="Mount disk to VG / 磁盘挂载到虚拟分区" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Tools.html" class="btn btn-neutral" title="Tools" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, BrianShen.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'Blog',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/disqus.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>