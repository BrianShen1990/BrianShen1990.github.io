<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Other Commands</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">KNOWN. </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/linux.html">Linux</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/Other_Commands.html" rel="bookmark"
           title="Permalink to Other Commands">Other Commands</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-26T00:00:00+08:00">
                Published: Mon 26 March 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/brian-shen.html">Brian Shen</a>
        </address>
<p>In <a href="/category/linux.html">Linux</a>.</p>
<p>tags: <a href="/tag/users.html">Users</a> <a href="/tag/linux.html">Linux</a> <a href="/tag/centos6.html">CentOS6</a> <a href="/tag/centos7.html">CentOS7</a> </p>
</footer><!-- /.post-info -->      <div class="contents topic" id="contents">
<span id="others-commands-rst"></span><p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#linux-version" id="id1">Linux Version</a><ul>
<li><a class="reference internal" href="#uname-centos-7-2" id="id2">uname &#64;&#64; CentOS 7.2</a></li>
<li><a class="reference internal" href="#uname-centos-6-9" id="id3">uname &#64;&#64; CentOS 6.9</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datetime" id="id4">Datetime</a><ul>
<li><a class="reference internal" href="#timedatectl-centos-7-2" id="id5">timedatectl &#64;&#64; CentOS 7.2</a></li>
<li><a class="reference internal" href="#date-centos-6-9" id="id6">date &#64;&#64; CentOS 6.9</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ntp-to-sync-time" id="id7">NTP to Sync Time</a></li>
<li><a class="reference internal" href="#add-user" id="id8">Add User</a></li>
<li><a class="reference internal" href="#language-installation-and-font-install" id="id9">Language Installation and Font Install</a><ul>
<li><a class="reference internal" href="#install-fontconfig" id="id10">Install fontconfig</a></li>
<li><a class="reference internal" href="#check-font-directory" id="id11">Check font directory</a></li>
<li><a class="reference internal" href="#copy-expected-one" id="id12">Copy expected one</a></li>
<li><a class="reference internal" href="#clear-font-cache" id="id13">Clear font cache</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sed" id="id14">sed</a></li>
<li><a class="reference internal" href="#mock-other-user-to-execute-commands" id="id15">Mock other user to execute commands</a></li>
<li><a class="reference internal" href="#tar" id="id16">tar</a></li>
<li><a class="reference internal" href="#curl" id="id17">curl</a></li>
<li><a class="reference internal" href="#find" id="id18">Find</a><ul>
<li><a class="reference internal" href="#file" id="id19">File</a></li>
<li><a class="reference internal" href="#content" id="id20">Content</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cron-job" id="id21">CRON Job</a></li>
</ul>
</div>
<div class="section" id="linux-version">
<h2><a class="toc-backref" href="#id1">Linux Version</a></h2>
<p>Linux Version &amp; CentOS Version</p>
<div class="section" id="uname-centos-7-2">
<h3><a class="toc-backref" href="#id2">uname &#64;&#64; CentOS 7.2</a></h3>
<div class="highlight"><pre><span></span>uname -a
<span class="c1"># Linux brian 2.6.32-279.OpenVA.3.5.1399.el6.x86_64 #1 SMP Wed Jul 19 05:33:05 PDT 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
cat /etc/redhat-release
<span class="c1"># CentOS Linux release 7.2.1511 (Core)</span>
</pre></div>
</div>
<div class="section" id="uname-centos-6-9">
<h3><a class="toc-backref" href="#id3">uname &#64;&#64; CentOS 6.9</a></h3>
<div class="highlight"><pre><span></span>uname -a
<span class="c1"># Linux centos6 2.6.32-696.el6.x86_64 #1 SMP Tue Mar 21 19:29:05 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
cat /etc/redhat-release
<span class="c1"># CentOS release 6.9 (Final)</span>
</pre></div>
</div>
</div>
<div class="section" id="datetime">
<h2><a class="toc-backref" href="#id4">Datetime</a></h2>
<div class="section" id="timedatectl-centos-7-2">
<h3><a class="toc-backref" href="#id5">timedatectl &#64;&#64; CentOS 7.2</a></h3>
<div class="highlight"><pre><span></span>date
<span class="c1"># Wed Nov  8 14:02:54 CST 2017</span>

timedatectl
<span class="c1">#       Local time: Wed 2017-11-08 14:24:29 CST</span>
<span class="c1">#   Universal time: Wed 2017-11-08 06:24:29 UTC</span>
<span class="c1">#         RTC time: Wed 2017-11-08 06:24:29</span>
<span class="c1">#        Time zone: Asia/Shanghai (CST, +0800)</span>
<span class="c1">#      NTP enabled: n/a</span>
<span class="c1"># NTP synchronized: no</span>
<span class="c1">#  RTC in local TZ: no</span>
<span class="c1">#       DST active: n/a</span>

sudo timedatectl set-time 2017-11-07
sudo timedatectl set-timezone Asia/Shanghai
sudo timedatectl set-time 14:25:00

timedatectl
<span class="c1">#       Local time: Tue 2017-11-07 14:25:02 CST</span>
<span class="c1">#   Universal time: Tue 2017-11-07 06:25:02 UTC</span>
<span class="c1">#         RTC time: Tue 2017-11-07 06:25:02</span>
<span class="c1">#        Time zone: Asia/Shanghai (CST, +0800)</span>
<span class="c1">#      NTP enabled: n/a</span>
<span class="c1"># NTP synchronized: no</span>
<span class="c1">#  RTC in local TZ: no</span>
<span class="c1">#       DST active: n/a</span>
</pre></div>
</div>
<div class="section" id="date-centos-6-9">
<h3><a class="toc-backref" href="#id6">date &#64;&#64; CentOS 6.9</a></h3>
<p>There are two kinds of time in CentOS 6
- System: sys (software time)
- BOIS: hc (hardware time)</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd>-<a class="reference external" href="http://blog.csdn.net/kimsoft/article/details/8091734">http://blog.csdn.net/kimsoft/article/details/8091734</a></dd>
</dl>
<div class="highlight"><pre><span></span>date
<span class="c1"># Tue Nov  7 22:10:11 CST 2017</span>

cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

hwclock
<span class="c1"># Tue 07 Nov 2017 10:41:32 PM CST  -0.052334 seconds</span>

date -s 20171107
<span class="c1"># Tue Nov  7 00:00:00 CST 2017</span>

date -s 14:42:00
<span class="c1"># Tue Nov  7 14:42:00 CST 2017</span>

hwclock -w
</pre></div>
</div>
</div>
<div class="section" id="ntp-to-sync-time">
<h2><a class="toc-backref" href="#id7">NTP to Sync Time</a></h2>
<div class="highlight"><pre><span></span>yum install ntp
systemctl <span class="nb">enable</span> ntpd
systemctl start ntpd
ntpstat
ntpq -p
</pre></div>
<dl class="docutils">
<dt>Reference:</dt>
<dd><ul class="first last simple">
<li>How to config Time and date on CentOS 7  <a class="reference external" href="https://www.hugeserver.com/kb/config-time-date-centos-7-ntp/">https://www.hugeserver.com/kb/config-time-date-centos-7-ntp/</a></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="add-user">
<h2><a class="toc-backref" href="#id8">Add User</a></h2>
<ul class="simple">
<li>Add Users</li>
</ul>
<div class="highlight"><pre><span></span>useradd brian
passwd brian
</pre></div>
<ul class="simple">
<li>Turn a user to Admin <code>visudo</code></li>
</ul>
<div class="highlight"><pre><span></span>Add a line below:
root     <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>        ALL
<span class="o">[</span>username<span class="o">]</span>     <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>        ALL
</pre></div>
</div>
<div class="section" id="language-installation-and-font-install">
<h2><a class="toc-backref" href="#id9">Language Installation and Font Install</a></h2>
<p>Usually, if we install CentOS with <code>minimal mode</code> , it won't include other language support.
I met one scenery today because I wanted to use <code>phantomjs</code> to generate a PDF report.
It didn't met my expectation as all Chinese was in chaos.</p>
<p>Here is the solution to solve it.</p>
<div class="section" id="install-fontconfig">
<h3><a class="toc-backref" href="#id10">Install fontconfig</a></h3>
<p><code>sudo yum -y install fontconfig</code></p>
</div>
<div class="section" id="check-font-directory">
<h3><a class="toc-backref" href="#id11">Check font directory</a></h3>
<p>Go to <code>/usr/shared/fonts</code></p>
</div>
<div class="section" id="copy-expected-one">
<h3><a class="toc-backref" href="#id12">Copy expected one</a></h3>
<p>You can choose to copy the folder from a CentOS with full installation.
Here is my menu:</p>
<div class="figure">
<img alt="" src="/_static/image/tools/others/others_01.png" />
</div>
</div>
<div class="section" id="clear-font-cache">
<h3><a class="toc-backref" href="#id13">Clear font cache</a></h3>
<p><code>sudo fc-cache</code></p>
<p>Reference:
<a class="reference external" href="https://blog.csdn.net/wlwlwlwl015/article/details/51482065">https://blog.csdn.net/wlwlwlwl015/article/details/51482065</a></p>
</div>
</div>
<div class="section" id="sed">
<h2><a class="toc-backref" href="#id14">sed</a></h2>
<ul>
<li><dl class="first docutils">
<dt>Append</dt>
<dd><p class="first last"><code>sed -i 'N;/      - 9003:9003/a\      - 9004:9004' /dataLog/docker-compose.yml</code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Append in the end of the file</dt>
<dd><p class="first last"><code>sed -i '$a\要插入的文字' file.txt</code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Search and Delete</dt>
<dd><p class="first last"><code>sed -i '/TDA_TREND/'d /dataLog/docker-compose.yml</code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Delete line</dt>
<dd><p class="first last"><code>sed -i '8d' FILE</code>
delete line 8</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Replace</dt>
<dd><p class="first last"><code>sed -i 's/_BUILD_NUM_/10/g' /dataLog/docker-compose-test.yml</code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Insert</dt>
<dd><p class="first last"><code>sed -i '8i8 This is Line 8' FILE</code>
inserts at line 8
8 This is Line 8</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="mock-other-user-to-execute-commands">
<h2><a class="toc-backref" href="#id15">Mock other user to execute commands</a></h2>
<p><code>su - admin -c &quot;bash build01.sh 0001&quot;</code></p>
</div>
<div class="section" id="tar">
<h2><a class="toc-backref" href="#id16">tar</a></h2>
<p>Compress and unzip:</p>
<div class="highlight"><pre><span></span>tar -zcf dataLog.2.4.<span class="nv">$BUILD_NUM</span>.tar.gz dataLog/
tar -xvf dataLog***.tar.gz &gt;&gt; <span class="nv">$LOGFILE</span>
</pre></div>
</div>
<div class="section" id="curl">
<h2><a class="toc-backref" href="#id17">curl</a></h2>
<p>How to retry when receive 400, 500 or Connection Refused.</p>
<div class="highlight"><pre><span></span>curl -H <span class="s2">&quot;Content-Type:application/json&quot;</span> --retry <span class="m">12</span> --retry-connrefused --retry-delay <span class="m">5</span> --max-time <span class="m">60</span> -XPOST http://localhost:9001/GRAY -d <span class="s1">&#39;{&quot;action&quot;:&quot;aisResetUIConfig&quot;,&quot;value&quot;: {}}&#39;</span>
</pre></div>
<p>For self signed website, use <code>--insecure</code> to get the response, or you may get error messages.</p>
<p>Reference:</p>
<p><a class="reference external" href="https://www.client9.com/using-curl-in-automation/">https://www.client9.com/using-curl-in-automation/</a></p>
</div>
<div class="section" id="find">
<h2><a class="toc-backref" href="#id18">Find</a></h2>
<div class="section" id="file">
<h3><a class="toc-backref" href="#id19">File</a></h3>
<blockquote>
<code>find / -name soffice</code></blockquote>
</div>
<div class="section" id="content">
<h3><a class="toc-backref" href="#id20">Content</a></h3>
<blockquote>
<code>grep -R &quot;.die&quot; ./www/html/html/</code></blockquote>
</div>
</div>
<div class="section" id="cron-job">
<h2><a class="toc-backref" href="#id21">CRON Job</a></h2>
<p>Add cron job:</p>
<div class="highlight"><pre><span></span><span class="c1"># in file /etc/crontab</span>
*/5 * * * * root /bin/bash /usr/bin/uapais diskMonitor
</pre></div>
<p>For per 5 minutes.</p>
<div class="warning">
<p class="first admonition-title">Warning</p>
<p>For Docker, we cannot add <code>-it</code> parameter, it will hang the whole shell command.
And join string in bash: <code>'{&quot;action&quot;:&quot;logDisk&quot;,&quot;value&quot;: {&quot;disk&quot;:&quot;'&quot;$UAPAISTEMP&quot;'&quot;}}'</code></p>
<div class="last"><div class="highlight"><pre><span></span>diskMonitor<span class="o">(){</span>
    <span class="nv">UAPAISTEMP</span><span class="o">=</span><span class="sb">`</span>df -h / <span class="p">|</span> grep dev<span class="sb">`</span>
    docker <span class="nb">exec</span> plugins-scripts curl -H <span class="s2">&quot;Content-Type:application/json&quot;</span> -XPOST http://10.21.137.45:9001/HOST_CONNECT -d <span class="s1">&#39;{&quot;action&quot;:&quot;logDisk&quot;,&quot;value&quot;: {&quot;disk&quot;:&quot;&#39;</span><span class="s2">&quot;</span><span class="nv">$UAPAISTEMP</span><span class="s2">&quot;</span><span class="s1">&#39;&quot;}}&#39;</span>
<span class="o">}</span>
</pre></div>
</div></div>
</div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>