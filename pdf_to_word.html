<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>PDF To Word / PDF转Word格式</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="KNOWN Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">KNOWN </a></h1>
                <nav><ul>
                    <li><a href="/category/node.html">Node</a></li>
                    <li class="active"><a href="/category/tools.html">Tools</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/pdf_to_word.html" rel="bookmark"
           title="Permalink to PDF To Word / PDF转Word格式">PDF To Word / PDF转Word格式</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-09-13T00:00:00+08:00">
                Published: Thu 13 September 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/brian-shen.html">Brian Shen</a>
        </address>
<p>In <a href="/category/tools.html">Tools</a>.</p>
<p>tags: <a href="/tag/linux.html">Linux</a> <a href="/tag/docker.html">Docker</a> <a href="/tag/libreoffice.html">LibreOffice</a> <a href="/tag/pdf.html">PDF</a> </p>
</footer><!-- /.post-info -->      <div class="contents topic" id="contents">
<span id="pdf-to-word-rst"></span><p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#intro" id="id1">Intro / 简介</a></li>
<li><a class="reference internal" href="#success-libreoffice" id="id2">Success - LibreOffice</a><ul>
<li><a class="reference internal" href="#failure-attempts" id="id3">Failure Attempts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#failure-abiword" id="id4">Failure - abiword</a></li>
<li><a class="reference internal" href="#failure-pandoc" id="id5">Failure - pandoc</a></li>
</ul>
</div>
<div class="section" id="intro">
<h2>1. <a class="toc-backref" href="#id1">Intro / 简介</a></h2>
<p>Here is the situation. I met some clients and they need reports. A quite normal feature request. I generated report using PhantomJS and sent them PDF reports.</p>
<p>一些客户需要产生报告，这是很正常的功能，我们可以通过 PhantomJS 产生PDF的报告。</p>
<p>But they were not satisfied because they need other editable formats like MS Word so that they can modify the report and use it.</p>
<p>但是客户并不满足与PDF的报告，他们还需要像Word这样的格式。</p>
<p>Word Format is not a standard format actually. So I faced lots difficulties. And since I already have HTML and PDF version, I don't want to change code up and down, I wish them controllable. So I searched for solutions how I can convert html or PDF to doc.</p>
<p>Word 并不是标准的格式，更不是面向代码的。这种情况下，既然有PDF 文档了，我更希望以最小的改动实现这个功能。</p>
<p>PhantomJS cannot do this. There is little solutions. I tried following ones and finally chose the solution using LibreOffice because the basic format can be kept.</p>
<p>PhantomJS 不能够完成这项任务。 解决方案很少。最终我是使用了LibreOffice 进行转换， 因为基本的格式都能够被保存下来。</p>
</div>
<div class="section" id="success-libreoffice">
<h2>2. <a class="toc-backref" href="#id2">Success - LibreOffice</a></h2>
<p>Documents that generated by LibreOffice keeps most formats, and it looks almost like the PDF content. That's great!</p>
<p>通过LibreOffice产生的文档基本保留了全部的格式，并且与PDF 有相同的渲染。非常棒。</p>
<p>But I still have some concerns. For example, it costs disk and makes installation more complex. But after compared with other solutions listed behind, I think it is totally acceptable.</p>
<p>但这里仍然会有一些疑虑，比方说，LibreOffice会使得安装过程更加的复杂，需要额外的磁盘等等。
但是比较完搜索到的方案，这些还是可以接受的。</p>
<p>While installing LibreOffice in Ubuntu and CentOS is very easy, just remember to install <code>gtk2.0</code> and so on because they are prerequisites.</p>
<p>在 Ubuntu 和 CentOS上安装 LibreOffice是非常方便的，但是一定要记得先安装  <code>gtk2.0</code> ， 因为这是前提。</p>
<div class="highlight"><pre><span></span>apt-get update
apt-get install gtk2.0
apt-get install -y software-properties-common
<span class="nb">cd</span> /root/LibreOffice_5.3.6.1_Linux_x86-64_deb/
dpkg -i *.deb
</pre></div>
<p>And use this <code>/opt/libreoffice5.3/program/soffice</code> in command line.</p>
<p>命令行中使用 <code>/opt/libreoffice5.3/program/soffice</code>  调用。</p>
<p>Convert <code>soffice --infilter=&quot;writer_pdf_import&quot; --convert-to doc file.pdf</code></p>
<p>转换使用的命令： <code>soffice --infilter=&quot;writer_pdf_import&quot; --convert-to doc file.pdf</code></p>
<p>See what happened:
转换完之后，我们看下PDF 和 Word的对比。</p>
<blockquote>
<div class="figure">
<img alt="" src="/images/tools/pdf_to_word_01.png" />
</div>
</blockquote>
<p>But I met obstacles in Docker because docker is not equipped with many dependencies.
This is my Dockerfile: (I downloaded the 5.3.6 version and copied them to docker.)</p>
<p>因为产品环境实在docker中运行的，安装还是有一些问题。
下面Dockerfile 文件：</p>
<div class="highlight"><pre><span></span>FROM node:6.14.0
ADD . Libre
RUN apt-get -y update <span class="o">&amp;&amp;</span> apt-get install -y software-properties-common <span class="o">&amp;&amp;</span> apt-get -y install gtk2.0  <span class="o">&amp;&amp;</span> <span class="nb">cd</span> /Libre/LibreOffice_5.3.6.1_Linux_x86-64_deb/ <span class="o">&amp;&amp;</span> dpkg -i *.deb
</pre></div>
<p>when use this docker image and call LibreOffice, there are tips as docker environment has no display.</p>
<p>在docker中使用 LibreOffice 时，会调用失败，如果不做特殊的设定的话。 因为docker环境默认是没有显示的。</p>
<p>Here is how to solve it:</p>
<p>可以 通过这样的方式解决：</p>
<div class="highlight"><pre><span></span>xxx:
  image: xxx
  container_name: xxx
  volumes:
    - /tmp/.X11-unix:/tmp/.X11-unix
  environment:
    - <span class="nv">DISPLAY</span><span class="o">=</span>unix:0
</pre></div>
<div class="section" id="failure-attempts">
<h3>2.1. <a class="toc-backref" href="#id3">Failure Attempts</a></h3>
<p>From LibreOffice official site (<a class="reference external" href="https://www.libreoffice.org/get-help/system-requirements/">https://www.libreoffice.org/get-help/system-requirements/</a>), there are some prerequisites:</p>
<p>在 LibreOffice的官网中，提到了一些前提， 要注意选择性的安装，否则会导致安装失败。</p>
<ul class="simple">
<li>glibc2 version 2.5 or higher  (check)(ldd --version)</li>
<li>apt-get install gtk2.0 (check)(dpkg -l libgtk2.0-0 libgtk-3-0)</li>
<li>Gnome 2.16 or higher</li>
<li>Instal from ppa</li>
</ul>
<div class="highlight"><pre><span></span>RUN awk <span class="s1">&#39;$1 ~ &quot;^deb&quot; { $3 = $3 &quot;-backports&quot;; print; exit }&#39;</span> /etc/apt/sources.list &gt; /etc/apt/sources.list.d/backports.list
apt-get update
apt-get install -y software-properties-common
add-apt-repository -y ppa:libreoffice/ppa
apt-get install -y <span class="nv">libreoffice</span><span class="o">=</span><span class="m">5</span>.3.6.1
</pre></div>
<ul class="simple">
<li>Install GNOME</li>
</ul>
<div class="highlight"><pre><span></span>apt-get install task-gnome-desktop --no-install-recommends
sudo apt-get install ubuntu-gnome-desktop --no-install-recommends
</pre></div>
</div>
</div>
<div class="section" id="failure-abiword">
<h2>3. <a class="toc-backref" href="#id4">Failure - abiword</a></h2>
<div class="highlight"><pre><span></span>apt-get -y update
apt-get -y install abiword
</pre></div>
<p>The output document keeps nearly no cascading styles. So give up this one.</p>
<p>abiword 导出的 Word 文件，基本是没有任何的 样式的。</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="https://askubuntu.com/questions/37548/pdf-to-word-conversion-software">https://askubuntu.com/questions/37548/pdf-to-word-conversion-software</a></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="failure-pandoc">
<h2>4. <a class="toc-backref" href="#id5">Failure - pandoc</a></h2>
<blockquote>
<code>yum install pandoc</code></blockquote>
<p>The output document only include basic text. Still give it up.</p>
<p>pandoc 导出的文件也是没有格式的。</p>
</div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <!--
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                        </ul>
                </div>
        </section>  --> <!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. The theme is adopted from <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-107750695-1', 'auto');
    ga('send', 'pageview');
    </script>
<script type="text/javascript">
    var disqus_shortname = 'brianshen1990';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>